# リファクタリング・コードレビュー知見集

## 📝 概要

コードリファクタリングやレビュー時に得られた重要な知見やベストプラクティスを記録。

## 🔧 リファクタリング時の注意点

### 1. 参照コメントの保護

**問題**: リファクタリング時に重要な参照情報を含むコメントを削除してしまう

**具体例**:
```typescript
// Before (重要な参照情報あり)
server: {
  hmr: {
    // set different port for HMR to avoid conflicts
    // cf. https://vite.dev/config/server-options.html#server-hmr
    port: 3000
  }
}

// After (参照情報を誤削除)
server: {
  hmr: {
    // HMRポートを分離してWebSocketとの競合を回避
    port: 3000
  }
}
```

**影響**:
- 設定の技術的根拠が失われる
- 将来の保守時に参照元が不明になる
- 他の開発者の理解を妨げる
- 学習価値の損失

**対策**:
- 公式ドキュメントURL等の参照情報は必ず保持
- リファクタリング前に重要コメントをマーク
- コメント変更時は参照情報の有無を確認
- レビュー時に参照情報の削除をチェック

### 2. コメント品質の原則

**重要度の高いコメント**:
1. 公式ドキュメントへのリンク
2. 設計判断の理由・根拠
3. 回避した問題の詳細
4. 外部仕様への参照

**削除可能なコメント**:
- コード自体で理解できる説明
- 古い情報や不正確な内容
- 冗長な説明

## 💡 レビューフィードバック活用

### 開発者フィードバックの価値
- **技術的な見落とし**: 自動化では発見困難な問題を指摘
- **ドメイン知識**: プロジェクト固有の重要情報
- **保守性観点**: 長期運用での問題点

### フィードバック対応方針
1. 指摘内容の技術的妥当性を検証
2. 根本原因を分析して再発防止策を策定
3. 知見として記録・共有
4. 開発プロセスの改善に反映

## 🔄 継続的改善

### 知見蓄積の重要性
- 同様の問題の再発防止
- 開発効率の向上
- チーム全体のスキル向上
- AIアシスタントの学習効果

### 記録すべき情報
- 問題の発生パターン
- 解決策の効果測定
- 代替案の比較検討
- 適用範囲・制約条件

---

**関連ファイル**:
- [開発環境トラブルシューティング](./troubleshooting.md)
- [プロジェクト統合レポート](./project-integration-report.md)
- [PlatformIOワークフロー](./platformio-workflow.md)
